import{_ as y}from"./AppLayout.6ac057e3.js";import{_ as g}from"./InputError.7a3a3fa2.js";import b from"./QList.2e0eff26.js";import{u as x,d as c,X as k,a3 as E,c as S,w as V,o as u,a as l,e as f,i as j,b as p,h as o,F as B,t as F,z as O,W as $}from"./app.3fc7250d.js";import"./Dropdown.392d814a.js";import"./SingleSelect.bc2b7fb9.js";import"./InputText.47d45497.js";import"./helpers.6ae94cef.js";import"./MultipleSelect.3f530fdd.js";const C={class:"bg-gray-100"},z={class:"max-w-6xl bg-white rounded-lg mt-5 py-6 mx-auto"},A={class:"sm:rounded-lg"},I={class:"p-6 w-full"},L={class:"px-6 flex justify-center pb-6"},H={__name:"Index",props:["survey","record","user"],setup(w){const i=w,r=x({answers:{},status:"ongoing"}),d=c([]),n=c([]);k(()=>{v()});const v=()=>{i.record==null?(i.survey.questions.forEach(e=>{if(e.setup.input==!0)r.answers["question_"+e.id]="";else if(e.setup.dropdown==!0||e.setup.multiple_select==!1){r.answers["question_"+e.id]=0;let s={};e.setup.choices.forEach(t=>{t.write_in&&(s["write_"+t.value]="")}),Object.keys(s).length>0&&(r.answers["write_in_"+e.id]=s)}else{let s={},t={};e.setup.choices.forEach(a=>{s["choice_"+a.value]=0,a.write_in&&(t["write_"+a.value]="")}),r.answers["question_"+e.id]=s,Object.keys(t).length>0&&(r.answers["write_in_"+e.id]=t)}}),i.user.user_type!="alumni"&&(r.status="test")):(r.answers=i.record.answers,r.status=i.record.status,i.survey.questions.forEach(e=>{if(e.setup.input==!0)"question_"+e.id in i.record.answers||(r.answers["question_"+e.id]="");else if(e.setup.dropdown==!0||e.setup.multiple_select==!1){if(!("question_"+e.id in i.record.answers)&&(r.answers["question_"+e.id]=0,e.setup.dropdown==!1)){let s={};e.setup.choices.forEach(t=>{t.write_in&&(s["write_"+t.value]="")}),Object.keys(s).length>0&&(r.answers["write_in_"+e.id]=s)}}else if("question_"+e.id in i.record.answers)e.setup.choices.forEach(s=>{"choice_"+s.value in i.record.answers["question_"+e.id]||(r.answers["question_"+e.id]["choice_"+s.value]=0,s.write_in&&(r.answers["write_in_"+e.id]["write_"+s.value]=""))});else{let s={},t={};e.setup.choices.forEach(a=>{s["choice_"+a.value]=0,a.write_in&&(t["write_"+a.value]="")}),r.answers["question_"+e.id]=s,Object.keys(t).length>0&&(r.answers["write_in_"+e.id]=t,console.table(t))}})),d.value=i.survey.questions},m=E.exports.debounce(()=>{r.post(route("surveys.engine.save_answer",{survey_id:i.survey.id}),{preserveScroll:!0,onSuccess:()=>{},onError:e=>{}})},1e3),h=()=>{let e=!0;n.value=[],i.survey.questions.forEach(s=>{if(s.setup.required)if(s.setup.dropdown==!0||s.setup.multiple_select==!1)r.answers["question_"+s.id]==0&&(e=!1,n.value[s.order-1]="* Required");else{e=!1,n.value[s.order-1]="* Required";for(const t in r.answers["question_"+s.id])if(r.answers["question_"+s.id][t]==1){e=!0,n.value[s.order-1]="";break}}}),e&&O.Inertia.get(route("surveys.engine.finish_survey",{survey_id:i.survey.id,status:r.status}))};return $("my_choices",r),(e,s)=>(u(),S(y,{title:"Survey"},{default:V(()=>[l("div",C,[l("div",z,[l("div",A,[(u(!0),f(B,null,j(d.value,(t,a)=>(u(),f("div",I,[p(g,{message:n.value[a]},null,8,["message"]),p(b,{disabled:o(r).status=="complete"&&t.setup.required,onChange:s[0]||(s[0]=_=>o(m)()),question:t,modelValue:o(r).answers["question_"+t.id],"onUpdate:modelValue":_=>o(r).answers["question_"+t.id]=_},null,8,["disabled","question","modelValue","onUpdate:modelValue"])]))),256)),l("div",L,[l("button",{onClick:s[1]||(s[1]=t=>h()),class:"flex text-white bg-green-500 border-0 py-2 px-8 focus:outline-none hover:bg-green-600 rounded text-lg"},F(o(r).status=="complete"?"Save Answers":"Finish Survey"),1)])])])])]),_:1}))}};export{H as default};
